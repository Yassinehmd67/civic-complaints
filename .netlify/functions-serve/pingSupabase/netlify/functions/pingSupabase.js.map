{
  "version": 3,
  "sources": ["../../../../Desktop/civic-complaints-backup/netlify/functions/pingSupabase.js"],
  "sourceRoot": "C:/Users/PC/AppData/Local/Temp/tmp-11528-j8k91Y5HdUGK",
  "sourcesContent": ["// netlify/functions/pingSupabase.js\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const config = { path: \"/.netlify/functions/pingSupabase\" };\r\n\r\nfunction cors(res) {\r\n  return {\r\n    ...res,\r\n    headers: {\r\n      \"Access-Control-Allow-Origin\": \"*\",\r\n      \"Access-Control-Allow-Headers\": \"Content-Type, Authorization\",\r\n      \"Access-Control-Allow-Methods\": \"GET,OPTIONS\",\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  };\r\n}\r\n\r\nexport async function handler(event) {\r\n  if (event.httpMethod === \"OPTIONS\") {\r\n    return cors({ statusCode: 200, body: \"\" });\r\n  }\r\n  if (event.httpMethod !== \"GET\") {\r\n    return cors({ statusCode: 405, body: JSON.stringify({ error: \"Method Not Allowed\" }) });\r\n  }\r\n\r\n  try {\r\n    const { SUPABASE_URL, SUPABASE_SERVICE_ROLE, SUPABASE_BUCKET } = process.env;\r\n    if (!SUPABASE_URL || !SUPABASE_SERVICE_ROLE || !SUPABASE_BUCKET) {\r\n      return cors({\r\n        statusCode: 500,\r\n        body: JSON.stringify({ ok: false, where: \"env\", error: \"Missing Supabase env vars\" }),\r\n      });\r\n    }\r\n\r\n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE);\r\n    const { data, error } = await supabase.storage.getBucket(SUPABASE_BUCKET);\r\n\r\n    if (error) {\r\n      return cors({\r\n        statusCode: 500,\r\n        body: JSON.stringify({ ok: false, where: \"storage\", error: error.message }),\r\n      });\r\n    }\r\n\r\n    return cors({\r\n      statusCode: 200,\r\n      body: JSON.stringify({ ok: true, bucket: data?.name || SUPABASE_BUCKET }),\r\n    });\r\n  } catch (e) {\r\n    return cors({\r\n      statusCode: 500,\r\n      body: JSON.stringify({ ok: false, where: \"catch\", error: e.message || String(e) }),\r\n    });\r\n  }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,yBAA6B;AAEtB,IAAM,SAAS,EAAE,MAAM,mCAAmC;AAEjE,SAAS,KAAK,KAAK;AACjB,SAAO;AAAA,IACL,GAAG;AAAA,IACH,SAAS;AAAA,MACP,+BAA+B;AAAA,MAC/B,gCAAgC;AAAA,MAChC,gCAAgC;AAAA,MAChC,gBAAgB;AAAA,IAClB;AAAA,EACF;AACF;AAEA,eAAsB,QAAQ,OAAO;AACnC,MAAI,MAAM,eAAe,WAAW;AAClC,WAAO,KAAK,EAAE,YAAY,KAAK,MAAM,GAAG,CAAC;AAAA,EAC3C;AACA,MAAI,MAAM,eAAe,OAAO;AAC9B,WAAO,KAAK,EAAE,YAAY,KAAK,MAAM,KAAK,UAAU,EAAE,OAAO,qBAAqB,CAAC,EAAE,CAAC;AAAA,EACxF;AAEA,MAAI;AACF,UAAM,EAAE,cAAc,uBAAuB,gBAAgB,IAAI,QAAQ;AACzE,QAAI,CAAC,gBAAgB,CAAC,yBAAyB,CAAC,iBAAiB;AAC/D,aAAO,KAAK;AAAA,QACV,YAAY;AAAA,QACZ,MAAM,KAAK,UAAU,EAAE,IAAI,OAAO,OAAO,OAAO,OAAO,4BAA4B,CAAC;AAAA,MACtF,CAAC;AAAA,IACH;AAEA,UAAM,eAAW,iCAAa,cAAc,qBAAqB;AACjE,UAAM,EAAE,MAAM,MAAM,IAAI,MAAM,SAAS,QAAQ,UAAU,eAAe;AAExE,QAAI,OAAO;AACT,aAAO,KAAK;AAAA,QACV,YAAY;AAAA,QACZ,MAAM,KAAK,UAAU,EAAE,IAAI,OAAO,OAAO,WAAW,OAAO,MAAM,QAAQ,CAAC;AAAA,MAC5E,CAAC;AAAA,IACH;AAEA,WAAO,KAAK;AAAA,MACV,YAAY;AAAA,MACZ,MAAM,KAAK,UAAU,EAAE,IAAI,MAAM,QAAQ,MAAM,QAAQ,gBAAgB,CAAC;AAAA,IAC1E,CAAC;AAAA,EACH,SAAS,GAAG;AACV,WAAO,KAAK;AAAA,MACV,YAAY;AAAA,MACZ,MAAM,KAAK,UAAU,EAAE,IAAI,OAAO,OAAO,SAAS,OAAO,EAAE,WAAW,OAAO,CAAC,EAAE,CAAC;AAAA,IACnF,CAAC;AAAA,EACH;AACF;",
  "names": []
}
